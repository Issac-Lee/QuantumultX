# 欢迎使用one-stop懒人配置文件
# 配置链接🔗 https://raw.githubusercontent.com/Issac-Lee/QuantumultX/main/one-stop.conf
# 原本目的是根据我自己使用需求进行修改后存档自己使用，但看到不少telegram群里的小白各种问问题，又不愿意花时间看使用教程，或者看不懂教程，就想着干脆发出来给大家免费用
# 本配置文件综合了各位大神的脚本和配置，更改了分流规则匹配顺序，去掉了一些冗余的规则，使用者可以根据自己实际需求自行增减
# 本配置文件引入了神机, blackmatrix7和lhie1重写规则, KOP-XIAO的geo-checker js脚本, ip-api数据库, GeQ1an部分去广告规则等，再次一并感谢各位大神
# 导入前请先删除证书，导入后再重新安装证书并信任
# 导入此懒人配置文件后，请点开圈叉设置打开重写和MitM，然后点击生成证书，接着点击配置证书，会自动跳转到Safari，点击允许后会自动下载描述文件。接着进到iPhone/iPad设置-通用-VPN与设备管理，点击已下载的描述文件（QuantumultX开头的）-安装。最后回到设置-关于本机-证书信任设置，打开证书信任即可
# 也可以在导入更新该配置前，把旧的配置中[MitM]类别中的passphrase和p12代码拷贝下来, 导入新的配置文件把内容粘贴在对应位置就不用删除再重装证书了
# 文件内有相关说明，请根据自己实际情况修改。小白别动，就直接用此版本即可
# 佛系更新

# ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

# 友情链接
# 脚本类
# https://github.com/NobyDa/Script
# https://github.com/KOP-XIAO/QuantumultX
# https://github.com/DivineEngine/Profiles/tree/master/Quantumult
# https://github.com/I-am-R-E/QuantumultX
# 图标类
# https://github.com/Orz-3/mini
# https://github.com/Orz-3/face
# https://github.com/Koolson/Qure
# GeoIP 链接
# Hackl0us GeoIP2-CN https://github.com/Hackl0us/GeoIP2-CN
# 🕔更新频率：每 3 天更新一次
# Country.mmdb（仅中国大陆）
# https://cdn.jsdelivr.net/gh/Hackl0us/GeoIP2-CN@release/Country.mmdb

# ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

[general]
excluded_routes=192.168.0.0/16, 10.0.0.0/8, 172.16.0.0/12, 100.64.0.0/10, 17.0.0.0/8
network_check_url=http://www.baidu.com/
server_check_url=http://www.gstatic.com/generate_204
resource_parser_url=https://cdn.jsdelivr.net/gh/KOP-XIAO/QuantumultX@master/Scripts/resource-parser.js
geo_location_checker=http://ip-api.com/json/?lang=zh-CN, https://raw.githubusercontent.com/I-am-R-E/Functional-Store-Hub/Master/GeoLocationChecker/QuantumultX/IP-API.js
;running_mode_trigger=filter, filter, asus-5g:all_direct, asus:all_proxy
# 上述写法，前两个 filter 表示 在 4G 网络跟一般 Wi-Fi 下，走 filter(分流)模式，asus-5g 则切换为全局直连，asus 切换为全局代理，使用者可根据自己实际情况进行修改，修改完毕后删除句首的;即可

[dns]
no-ipv6
server=223.5.5.5
server=119.29.29.29
server=114.114.114.114
server=8.8.8.8

[policy]
# 国内流媒体 分流为中国媒体（包括A站、B站、爱奇艺等）；国外流媒体 为国际媒体（包括HULU、HBO等）；  
# Mainland 为访问大部分大陆网站时的分流策略；Outside 指定访问境外网站时的分流；
# Others 为其他规则，若前边的规则都没有被匹配到，则听从此策略组的规定。
# 策略想走特定节点或套娃，请长按分流策略组自行添加节点/策略组

;url-latency-benchmark=延迟最低(Minimum Latency), server-tag-regex=^((?!(专线|手游|游戏|(?i)IPLC|IEPL|BGP|CN2|game)).)*$, check-interval=1800, tolerance=0, img-url=https://cdn.jsdelivr.net/gh/Koolson/Qure@master/IconSet/Color/Auto.png

# 自动测延迟（每30分钟测一次），优选延迟最低的节点。当前使用节点延迟和最新测速延迟最低的节点相差0ms以上则切换为最新的最低延迟节点，否则继续延用节点。考虑到大部分机场的专线节点和游戏节点倍率较高，因此上面策略组排除了专线节点和游戏节点。如若使用上面策略组，记得删除;使其生效，并在下面未排除专线节点的策略组句首添加;注释掉

url-latency-benchmark=延迟最低(Minimum Latency), server-tag-regex=.*, check-interval=1800, tolerance=0, img-url=https://cdn.jsdelivr.net/gh/Koolson/Qure@master/IconSet/Color/Auto.png

# 以下为排除专线节点的地域策略组，自动测延迟（每30分钟测一次），优选延迟最低的节点。当前使用节点延迟和最新测速延迟最低的节点相差0ms以上则切换为最新的最低延迟节点，否则继续延用节点。如需使用，删掉策略组前面的；即可

;url-latency-benchmark=🇭🇰香港(Hong Kong), server-tag-regex=(?=.*(🇭🇰|香港|HK|(?i)Hong))^((?!(专线|手游|游戏|(?i)IPLC|IEPL|BGP|CN2|game)).)*$, check-interval=1800, tolerance=0, img-url=https://cdn.jsdelivr.net/gh/Koolson/Qure@master/IconSet/Color/Hong_Kong.png
;url-latency-benchmark=🇹🇼台湾(Taiwan), server-tag-regex=(?=.*(🇹🇼|台湾|台灣|TW|(?i)Taiwan))^((?!(专线|手游|游戏|(?i)IPLC|IEPL|BGP|CN2|game)).)*$, check-interval=1800, tolerance=0, img-url=https://cdn.jsdelivr.net/gh/Koolson/Qure@master/IconSet/Color/Taiwan.png
;url-latency-benchmark=🇯🇵日本(Japan), server-tag-regex=(?=.*(🇯🇵|日本|JP|(?i)Japan))^((?!(专线|手游|游戏|(?i)IPLC|IEPL|BGP|CN2|game)).)*$, check-interval=1800, tolerance=0, img-url=https://cdn.jsdelivr.net/gh/Koolson/Qure@master/IconSet/Color/Japan.png
;url-latency-benchmark=🇰🇷韩国(Korea), server-tag-regex=(?=.*(🇰🇷|韩国|韓國|南朝鲜|KR|(?i)Korean))^((?!(专线|手游|游戏|(?i)IPLC|IEPL|BGP|CN2|game)).)*$, check-interval=1800, tolerance=0, img-url=https://cdn.jsdelivr.net/gh/Koolson/Qure@master/IconSet/Color/Korea.png
;url-latency-benchmark=🇸🇬新加坡(Singapore), server-tag-regex=(?=.*(🇸🇬|新加坡|狮城|SG|(?i)Singapore))^((?!(专线|手游|游戏|(?i)IPLC|IEPL|BGP|CN2|game)).)*$, check-interval=1800, tolerance=0, img-url=https://cdn.jsdelivr.net/gh/Koolson/Qure@master/IconSet/Color/Singapore.png
;url-latency-benchmark=🇺🇸美国(United States), server-tag-regex=(?=.*(🇺🇸|美国|美國|US|(?i)States|American))^((?!(专线|手游|游戏|(?i)IPLC|IEPL|BGP|CN2|game)).)*$, check-interval=1800, tolerance=0, img-url=https://cdn.jsdelivr.net/gh/Koolson/Qure@master/IconSet/Color/United_States.png

# 以下为不排除专线节点的地域策略组，自动测延迟（每30分钟测一次），优选延迟最低的节点。当前使用节点延迟和最新测速延迟最低的节点相差0ms以上则切换为最新的最低延迟节点，否则继续延用节点。如需使用，删掉策略组前面的；即可

;url-latency-benchmark=🇭🇰香港(Hong Kong), server-tag-regex=(?=.*(🇭🇰|香港|HK|(?i)Hong)), check-interval=1800, tolerance=0, img-url=https://cdn.jsdelivr.net/gh/Koolson/Qure@master/IconSet/Color/Hong_Kong.png
;url-latency-benchmark=🇹🇼台湾(Taiwan), server-tag-regex=(?=.*(🇹🇼|台湾|台灣|TW|(?i)Taiwan)), check-interval=1800, tolerance=0, img-url=https://cdn.jsdelivr.net/gh/Koolson/Qure@master/IconSet/Color/Taiwan.png
;url-latency-benchmark=🇯🇵日本(Japan), server-tag-regex=(?=.*(🇯🇵|日本|JP|(?i)Japan)), check-interval=1800, tolerance=0, img-url=https://cdn.jsdelivr.net/gh/Koolson/Qure@master/IconSet/Color/Japan.png
;url-latency-benchmark=🇰🇷韩国(Korea), server-tag-regex=(?=.*(🇰🇷|韩国|韓國|南朝鲜|KR|(?i)Korean)), check-interval=1800, tolerance=0, img-url=https://cdn.jsdelivr.net/gh/Koolson/Qure@master/IconSet/Color/Korea.png
;url-latency-benchmark=🇸🇬新加坡(Singapore), server-tag-regex=(?=.*(🇸🇬|新加坡|狮城|SG|(?i)Singapore)), check-interval=1800, tolerance=0, img-url=https://cdn.jsdelivr.net/gh/Koolson/Qure@master/IconSet/Color/Singapore.png
;url-latency-benchmark=🇺🇸美国(United States), server-tag-regex=(?=.*(🇺🇸|美国|美國|US|(?i)States|American)), check-interval=1800, tolerance=0, img-url=https://cdn.jsdelivr.net/gh/Koolson/Qure@master/IconSet/Color/United_States.png

# 以下为不排除专线节点的地域策略组，手动选择节点。如需使用，删掉策略组前面的；即可

;static=🇭🇰香港(Hong Kong), server-tag-regex=(?=.*(🇭🇰|香港|HK|(?i)Hong)), img-url=https://cdn.jsdelivr.net/gh/Koolson/Qure@master/IconSet/Color/Hong_Kong.png
;static=🇹🇼台湾(Taiwan), server-tag-regex=(?=.*(🇹🇼|台湾|台灣|TW|(?i)Taiwan)), img-url=https://cdn.jsdelivr.net/gh/Koolson/Qure@master/IconSet/Color/Taiwan.png
;static=🇯🇵日本(Japan), server-tag-regex=(?=.*(🇯🇵|日本|JP|(?i)Japan)), img-url=https://cdn.jsdelivr.net/gh/Koolson/Qure@master/IconSet/Color/Japan.png
;static=🇰🇷韩国(Korea), server-tag-regex=(?=.*(🇰🇷|韩国|韓國|南朝鲜|KR|(?i)Korean)), img-url=https://cdn.jsdelivr.net/gh/Koolson/Qure@master/IconSet/Color/Korea.png
;static=🇸🇬新加坡(Singapore), server-tag-regex=(?=.*(🇸🇬|新加坡|狮城|SG|(?i)Singapore)), img-url=https://cdn.jsdelivr.net/gh/Koolson/Qure@master/IconSet/Color/Singapore.png
;static=🇺🇸美国(United States), server-tag-regex=(?=.*(🇺🇸|美国|美國|US|(?i)States|American)), img-url=https://cdn.jsdelivr.net/gh/Koolson/Qure@master/IconSet/Color/United_States.png

Static=专线(Private Line), server-tag-regex=(手游|游戏|专线|(?i)IPLC|IEPL|BGP|CN2|game), img-url=https://cdn.jsdelivr.net/gh/Koolson/Qure@master/IconSet/Color/Server.png

static=Netflix, proxy, direct, reject, 延迟最低(Minimum Latency), 专线(Private Line), img-url=https://cdn.jsdelivr.net/gh/Koolson/Qure@master/IconSet/Color/Netflix_Letter.png
static=Disney+, proxy, direct, reject, 延迟最低(Minimum Latency), 专线(Private Line), img-url=https://cdn.jsdelivr.net/gh/Koolson/Qure@master/IconSet/Color/Disney%2B_1.png
static=YouTube, proxy, direct, reject, 延迟最低(Minimum Latency), 专线(Private Line), img-url=https://cdn.jsdelivr.net/gh/Koolson/Qure@master/IconSet/Color/YouTube.png
static=Telegram, proxy, direct, reject, 延迟最低(Minimum Latency), 专线(Private Line), img-url=https://cdn.jsdelivr.net/gh/Koolson/Qure@master/IconSet/Color/Telegram.png
static=Twitter, proxy, direct, reject, 延迟最低(Minimum Latency), 专线(Private Line), img-url=https://cdn.jsdelivr.net/gh/Koolson/Qure@master/IconSet/Color/Twitter.png
static=国外流媒体(GB Media), proxy, direct, reject, 延迟最低(Minimum Latency), 专线(Private Line), img-url=https://cdn.jsdelivr.net/gh/Koolson/Qure@master/IconSet/Color/ForeignMedia.png
static=Speedtest, proxy, direct, reject, 延迟最低(Minimum Latency), 专线(Private Line), img-url=https://cdn.jsdelivr.net/gh/Koolson/Qure@master/IconSet/Color/Speedtest.png
static=境外网站(Global), proxy, direct, reject, 延迟最低(Minimum Latency), 专线(Private Line), img-url=https://cdn.jsdelivr.net/gh/Koolson/Qure@master/IconSet/Color/Global.png
static=漏网之鱼(Others), proxy, direct, reject, 延迟最低(Minimum Latency), 专线(Private Line), img-url=https://cdn.jsdelivr.net/gh/Koolson/Qure@master/IconSet/Color/Final.png

[server_local]
# 本地服务器部分, 自行添加即可

[server_remote]
# 节点远程订阅
# 在update-interval前面添加as-policy=static可以生成对应的策略组

[filter_remote]
# 远程分流规则策略组
https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/QuantumultX/Advertising/Advertising.list, tag=广告拦截(Ad Block), force-policy=reject, update-interval=172800, opt-parser=false, enabled=true
https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/QuantumultX/Netflix/Netflix.list, tag=Netflix, force-policy=Netflix, update-interval=172800, opt-parser=false, enabled=true
https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/QuantumultX/Disney/Disney.list, tag=Disney+, force-policy=Disney+, update-interval=172800, opt-parser=false, enabled=true
https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/QuantumultX/YouTube/YouTube.list, tag=YouTube, force-policy=YouTube, update-interval=172800, opt-parser=false, enabled=true
https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/QuantumultX/Telegram/Telegram.list, tag=Telegram, force-policy=Telegram, update-interval=172800, opt-parser=false, enabled=true
https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/QuantumultX/Twitter/Twitter.list, tag=Twitter, force-policy=Twitter, update-interval=172800, opt-parser=false, enabled=true
https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/QuantumultX/GlobalMedia/GlobalMedia.list, tag=国外流媒体(GB Media), force-policy=国外流媒体(GB Media), update-interval=172800, opt-parser=false, enabled=true
https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/QuantumultX/Speedtest/Speedtest.list, tag=Speedtest, force-policy=Speedtest, update-interval=172800, opt-parser=false, enabled=true
https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/QuantumultX/Global/Global.list, tag=境外网站(Global), force-policy=境外网站(Global), update-interval=172800, opt-parser=false, enabled=true
https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/QuantumultX/Apple/Apple.list, tag=苹果(Apple), force-policy=direct, update-interval=172800, opt-parser=false, enabled=true

[filter_local]
# 本地分流规则(相同规则下，本地规则将覆盖远程规则，优先生效)
# 系统更新直连
host, ns.itunes.apple.com, direct
host, appldnld.apple.com, direct
host, mesu.apple.com, direct
host, xp.apple.com, direct
host, gdmf.apple.com, direct

# 避免迅雷版权问题
host, hub5idx.v6.shub.sandai.net, reject
host, hub5emu.v6.shub.sandai.net, reject
host, hub5btmain.v6.shub.sandai.net, reject

# 银行
HOST-SUFFIX,95599.cn, direct
HOST-SUFFIX,abchina.com, direct
HOST-SUFFIX,bscabank.com, direct
HOST-SUFFIX,openaboc.cn, direct
HOST-SUFFIX,openaboc.com, direct
HOST-SUFFIX,openaboc.com.cn, direct

# 其他
host-suffix, local, direct
host-keyword, yattazen, proxy
host, jdsharedresourcescdn.azureedge.net, proxy
ip-cidr, 10.0.0.0/8, direct
ip-cidr, 17.0.0.0/8, direct
ip-cidr, 100.64.0.0/10, direct
ip-cidr, 127.0.0.0/8, direct
ip-cidr, 172.16.0.0/12, direct
ip-cidr, 192.168.0.0/16, direct
geoip, cn, direct
final, 漏网之鱼(Others)

[rewrite_remote]
https://raw.githubusercontent.com/NobyDa/Script/master/QuantumultX/Js_Remote_Cookie.conf, tag=野比大佬签到cookie获取, update-interval=172800, opt-parser=false, enabled=true
https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rewrite/QuantumultX/AllInOne/AllInOne.conf, tag=blackmatrix7去广告规则, update-interval=172800, opt-parser=false, enabled=true
https://raw.githubusercontent.com/Orz-3/QuantumultX/master/YouTube.conf, tag=YouTube去广告, update-interval=172800, opt-parser=false, enabled=true
https://raw.githubusercontent.com/chavyleung/scripts/master/box/rewrite/boxjs.rewrite.quanx.conf, tag=boxjs, update-interval=172800, opt-parser=false, enabled=true
https://raw.githubusercontent.com/DivineEngine/Profiles/master/Quantumult/Rewrite/General.conf, tag=神机Google重定向, update-interval=172800, opt-parser=false, enabled=true
https://raw.githubusercontent.com/w37fhy/QuantumultX/master/QuantumultX_JS.conf, tag=淘宝京东比价, update-interval=172800, opt-parser=false, enabled=true

[rewrite_local]
# 本地复写规则

[task_local]
# 构造请求，脚本区，自行找库添加。
event-interaction https://raw.githubusercontent.com/KOP-XIAO/QuantumultX/master/Scripts/switch-check-google.js, tag=Google 切换, img-url=https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Google.png, enabled=true
event-interaction https://raw.githubusercontent.com/KOP-XIAO/QuantumultX/master/Scripts/traffic-check.js, tag=策略流量查询, img-url=https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Download.png, enabled=true
event-interaction https://raw.githubusercontent.com/KOP-XIAO/QuantumultX/master/Scripts/streaming-ui-check.js, tag=流媒体-解锁查询, img-url=checkmark.seal.system, enabled=true
event-interaction https://raw.githubusercontent.com/KOP-XIAO/QuantumultX/master/Scripts/geo_location.js, tag=GeoIP 查询, img-url=location.fill.viewfinder.system
0 0 1 1 * https://raw.githubusercontent.com/chavyleung/scripts/master/box/scripts/boxjs.revert.caches.js, tag=抹除BoxJs订阅缓存, enabled=false
0 */2 * * * https://raw.githubusercontent.com/Hyseen/Scripts/master/QuantumultX/NetflixPolicySwitcher/netflix_checker.js, tag=Netflix 解锁检测, img-url=https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Netflix_Letter.png, enabled=false

[http_backend]
# BoxJs相关教程参考https://chavyleung.gitbook.io/boxjs/
https://raw.githubusercontent.com/chavyleung/scripts/master/chavy.box.js, tag=BoxJS, path=^/, enabled=true

[mitm]
# passphrase和p12代为证书&主机名部分, 更新配置前可把旧的配置中passphrase和p12代码拷贝下来, 导入新的配置文件把内容粘贴在对应位置就不用重装证书了

